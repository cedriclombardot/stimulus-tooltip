{"version":3,"file":"index.modern.js","sources":["../src/index.js"],"sourcesContent":["import { Controller } from '@hotwired/stimulus';\nimport './index.scss';\n\nexport default class extends Controller {\n  static targets = ['tip', 'content'];\n  static values = {\n    position: { type: String, default: 'top' }\n  };\n\n  offset = null;\n\n  show(e) {\n    this.offset = this.compute(this.positionValue);\n    this.tipTarget.style.top = this.offset.top + 'px';\n    this.tipTarget.style.left = this.offset.left + 'px';\n    this.toggleClass(true);\n    this.dispatch('shown', { detail: { content: this.contentTarget, tip: this.tipTarget } });\n  }\n\n  hide(e) {\n    this.toggleClass(false);\n    this.dispatch('hidden', { detail: { content: this.contentTarget, tip: this.tipTarget } });\n  }\n\n  toggleClass(visible) {\n    let position = this.offset.position;\n    let kind = this.offset.position.split('-')[0];\n    if (visible) {\n      this.element.classList.add('st-tooltip--visible');\n      this.tipTarget.classList.add(`st-tooltip__tip--${kind}`, `st-tooltip__tip--${position}`)\n    } else {\n      this.element.classList.remove('st-tooltip--visible');\n      this.tipTarget.classList.remove(`st-tooltip__tip--${kind}`, `st-tooltip__tip--${position}`)\n    }\n  }\n\n  compute(position) {\n    let positions = this.detailPositions(position);\n    for (let i in positions) {\n      let offset = this.computeOffset(positions[i]);\n      if (!this.isOverflow(offset)) {\n        return offset;\n      }\n    }\n    return this.computeOffset(positions[0]);\n  }\n\n  detailPositions(position) {\n    return {\n      'top': ['top-start', 'top-end', 'bottom-start', 'bottom-end'],\n      'top-start': ['top-start', 'top-end', 'bottom-start', 'bottom-end'],\n      'top-end': ['top-end', 'top-start', 'bottom-end', 'bottom-start'],\n      'bottom': ['bottom-start', 'bottom-end', 'top-start', 'top-end'],\n      'bottom-start': ['bottom-start', 'bottom-end', 'top-start', 'top-end'],\n      'bottom-end': ['bottom-end', 'bottom-start', 'top-end', 'top-start'],\n      'left': ['left-start', 'left-end', 'right-start', 'right-end'],\n      'left-start': ['left-start', 'left-end', 'right-start', 'right-end'],\n      'left-end': ['left-end', 'left-start', 'right-end', 'right-start'],\n      'right': ['right-start', 'right-end', 'left-start', 'left-end'],\n      'right-start': ['right-start', 'right-end', 'left-start', 'left-end'],\n      'right-end': ['right-end', 'right-start', 'left-end', 'left-start'],\n    }[position];\n  }\n\n  computeOffset(position) {\n    let content = this.contentTarget;\n    let tip = this.tipTarget;\n    let offset = { position: position };\n\n    switch (position) {\n    case 'top-start':\n      offset.top = content.offsetTop - tip.offsetHeight;\n      offset.left = content.offsetLeft;\n      break;\n    case 'top-end':\n      offset.top = content.offsetTop - tip.offsetHeight;\n      offset.left = content.offsetLeft + content.offsetWidth - tip.offsetWidth;\n      break;\n    case 'bottom-start':\n      offset.top = content.offsetTop + content.offsetHeight;\n      offset.left = content.offsetLeft;\n      break;\n    case 'bottom-end':\n      offset.top = content.offsetTop + content.offsetHeight;\n      offset.left = content.offsetLeft + content.offsetWidth - tip.offsetWidth;\n      break;\n    case 'left-start':\n      offset.top = content.offsetTop;\n      offset.left = content.offsetLeft - tip.offsetWidth;\n      break;\n    case 'left-end':\n      offset.top = content.offsetTop + content.offsetHeight - tip.offsetHeight;\n      offset.left = content.offsetLeft - tip.offsetWidth;\n      break;\n    case 'right-start':\n      offset.top = content.offsetTop;\n      offset.left = content.offsetLeft + content.offsetWidth;\n      break;\n    case 'right-end':\n      offset.top = content.offsetTop + content.offsetHeight - tip.offsetHeight;\n      offset.left = content.offsetLeft + content.offsetWidth;\n      break;\n    }\n    offset.bottom = offset.top + this.tipTarget.offsetHeight;\n    offset.right = offset.left + this.tipTarget.offsetWidth;\n    return offset;\n  }\n\n  isOverflow(offset) {\n    return offset.top < window.scrollY || offset.bottom > window.innerHeight + window.scrollY ||\n           offset.left < window.scrollX || offset.right > window.innerWidth + window.scrollX;\n  }\n}\n"],"names":["Controller","offset","show","e","this","compute","positionValue","tipTarget","style","top","left","toggleClass","dispatch","detail","content","contentTarget","tip","hide","visible","position","kind","split","element","classList","add","remove","positions","detailPositions","i","computeOffset","isOverflow","bottom","right","offsetTop","offsetHeight","offsetLeft","offsetWidth","window","scrollY","innerHeight","scrollX","innerWidth","targets","values","type","String","default"],"mappings":"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"}